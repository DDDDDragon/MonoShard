C# part of MonoShard, contains the logic.
